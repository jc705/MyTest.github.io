window.__require=function t(e,n,i){function o(s,c){if(!n[s]){if(!e[s]){var u=s.split("/");if(u=u[u.length-1],!e[u]){var l="function"==typeof __require&&__require;if(!c&&l)return l(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+s+"'")}s=u}var a=n[s]={exports:{}};e[s][0].call(a.exports,function(t){return o(e[s][1][t]||t)},a,a.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)o(i[s]);return o}({"CanvasVideo ":[function(t,e,n){"use strict";cc._RF.push(e,"97b4a+8tjJLbZqF167K6xQG","CanvasVideo ");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},s=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function s(t){try{u(i.next(t))}catch(e){r(e)}}function c(t){try{u(i.throw(t))}catch(e){r(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,c)}u((i=i.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return u([t,e])}}function u(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(c){r=[6,c],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("./common/txySdk"),l=cc._decorator,a=l.ccclass,p=(l.property,l.requireComponent),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.liveBtn=null,e.quitBtn=null,e.openBtn=null,e.closeBtn=null,e.pullBtn=null,e.playBtn=null,e.pauseBtn=null,e.spriteFrameCache=[],e.index=0,e}return o(e,t),e.prototype.start=function(){var t=this,e=document.createElement("div");e.setAttribute("id","local_video"),e.setAttribute("style","position: absolute; bottom: 0px; left: 0px; z-index: 0; visibility: visible; width: 0%; height: 0%; transform: matrix(0.5, 0, 0, 0.5, 12.5, -8.5); transform-origin: 0px 100% 0px;"),document.body.appendChild(e),this.liveBtn=cc.find("layout/live",this.node.parent),this.quitBtn=cc.find("layout/quit",this.node.parent),this.openBtn=cc.find("layout/openCamera",this.node.parent),this.closeBtn=cc.find("layout/closeCamera",this.node.parent),this.pullBtn=cc.find("layout/pull",this.node.parent),this.playBtn=cc.find("layout/play",this.node.parent),this.pauseBtn=cc.find("layout/pause",this.node.parent),this.liveBtn.on("click",this.onClickLiveBtn.bind(this)),this.quitBtn.on("click",this.onClickQuitBtn.bind(this)),this.openBtn.on("click",this.onClickOpenBtn.bind(this)),this.closeBtn.on("click",this.onClickCloseBtn.bind(this)),this.pullBtn.on("click",this.onClickPullBtn.bind(this)),this.playBtn.on("click",this.onClickPlayBtn.bind(this)),this.pauseBtn.on("click",this.onClickPauseBtn.bind(this)),this.liveBtn.active=!1,this.quitBtn.active=!1,this.openBtn.active=!1,this.closeBtn.active=!1,this.pullBtn.active=!1,this.playBtn.active=!1,this.pauseBtn.active=!1;var n=function(){console.log("fun"),null!=window.TXLivePusher?(u.default.inst.initSdk(),t.liveBtn.active=!0,t.quitBtn.active=!0,t.openBtn.active=!0,t.closeBtn.active=!0,t.pullBtn.active=!0,t.playBtn.active=!0,t.pauseBtn.active=!0):t.scheduleOnce(function(){n()},1)};n()},e.prototype.onClickLiveBtn=function(){this.visSize=new cc.Size(this.node.width,this.node.height),this.init()},e.prototype.onClickQuitBtn=function(){u.default.inst.stoplive()},e.prototype.onClickOpenBtn=function(){u.default.inst.SwitchCamera(!0)},e.prototype.onClickCloseBtn=function(){u.default.inst.SwitchCamera(!1)},e.prototype.onClickPullBtn=function(){u.default.inst.pullLive(10001)},e.prototype.onClickPlayBtn=function(){u.default.inst.SwitchPlayLive(!0)},e.prototype.onClickPauseBtn=function(){u.default.inst.SwitchPlayLive(!1)},e.prototype.init=function(){var t=this,e=document.createElement("canvas");e.width=this.node.width,e.height=this.node.height,this._canvas=e,this._canvasCtx=e.getContext("2d"),this._sprite=this.getComponent(cc.Sprite),this._texture=new cc.Texture2D;for(var n=0;n<2;n++)this.spriteFrameCache.push(new cc.SpriteFrame);this.bind(function(){u.default.inst.livePush(10001),t.unschedule(t.updateTexture),t.schedule(t.updateTexture,.04,cc.macro.REPEAT_FOREVER)})},e.prototype.updateTexture=function(){return s(this,void 0,Promise,function(){var t;return c(this,function(){return null==this._video?[2]:(this._canvasCtx.drawImage(this._video,0,0,this.visSize.width,this.visSize.height),this._texture.initWithElement(this._canvas),(t=this.spriteFrameCache[this.index]).setTexture(this._texture),this._sprite.spriteFrame=t,this.index=1^this.index,[2])})})},e.prototype.bind=function(t){this._video=document.querySelector("#local_video").children[0],t()},e.prototype.handleSuccess=function(){},e.prototype.handleError=function(t){console.log("\u7ed1\u5b9a\u5931\u8d25:"),console.log(t)},e.prototype.clearSprite=function(){this._sprite.spriteFrame=null},r([a,p(cc.Sprite)],e)}(cc.Component);n.default=h,cc._RF.pop()},{"./common/txySdk":"txySdk"}],GlobelContext:[function(t,e,n){"use strict";cc._RF.push(e,"d52c7CqhixGMpdToUdxzngT","GlobelContext"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.TXYLicenseURL="https://license.vod2.myqcloud.com/license/v2/1311608929_1/v_cube.license",t.TXYPushKey="85fcf25bd2f894e16cb461fe37c0ab83",t.AppName="ouone",t.PushStreamUrl="168799.livepush.myqcloud.com",t.PullStreamUrl="push.ouwan.hmzb.top.txlivecdn.com",t.url="",t}();n.default=i,cc._RF.pop()},{}],ReqHttp:[function(t,e,n){"use strict";cc._RF.push(e,"2fb017Mu31DW6ZqCLZaDXp5","ReqHttp"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.getInst=function(){return this._inst||(this._inst=new t),this._inst},Object.defineProperty(t,"inst",{get:function(){return this.getInst()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"xhr",{get:function(){return this._xhr||(this._xhr=cc.loader.getXMLHttpRequest()),this._xhr},enumerable:!1,configurable:!0}),t.post=function(t,e,n){var i=this.xhr;i.open("POST",t),i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<=207){var t=i.responseText;n(t)}},i.send(e)},t.get=function(t,e,n){var i=this.xhr;i.open("GET",t+e),i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<=207){var t=i.responseText;n(t)}},i.send()},t._inst=null,t._xhr=null,t}();n.default=i,cc._RF.pop()},{}],test2:[function(t,e,n){"use strict";cc._RF.push(e,"1fbf8Z4yHxF17SGRgp2kpLm","test2");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var s=t("./txySdk"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){s.default.inst.initSdk(),s.default.inst.livePush()},r([u],e)}(cc.Component));n.default=l,cc._RF.pop()},{"./txySdk":void 0}],test:[function(t,e,n){"use strict";cc._RF.push(e,"9a5aeQuIWZNqJrTSr+WITEF","test");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){if(window.wx){console.log("wx:"),console.log(window.wx);var t=window.wx;t.getUserInfo({success:function(t){console.log(t)}}),this.scheduleOnce(function(){var e={appId:"wxec08df14b53cbf89",path:"",success:function(){console.log("navigateToMiniProgram succ!!!")},fail:function(){console.log("navigateToMiniProgram fail!!!")}};t.navigateToMiniProgram(e)},5)}},r([c],e)}(cc.Component));n.default=u,cc._RF.pop()},{}],txySdk:[function(t,e,n){"use strict";cc._RF.push(e,"89808JMGt9O5bpGwBRgJMhI","txySdk"),Object.defineProperty(n,"__esModule",{value:!0});var i=t("./GlobelContext"),o=function(){function t(){this._TXLivePusher=null,this._TCPlayer=null,this._content="local_video",this._player_container_id="player-container-id",this._livePusher=null,this._player=null}return t.getInst=function(){return this._inst||(this._inst=new t),this._inst},Object.defineProperty(t,"inst",{get:function(){return this.getInst()},enumerable:!1,configurable:!0}),t.prototype.initSdk=function(){this._TXLivePusher=window.TXLivePusher,this._TCPlayer=window.TCPlayer,this._TXLivePusher&&(this._livePusher=new this._TXLivePusher,console.log(this._livePusher),this._livePusher.setRenderView(this._content),this._livePusher.videoView.muted=!0,this._livePusher.observer.onPushStatusUpdate=function(t,e){console.log("onPushStatusUpdate"),console.log(t),console.log(e)},this._livePusher.observer.onCaptureFirstVideoFrame=function(){console.log("\u97f3\u50cf\u91c7\u96c6\u5b8c\u6210")},this._livePusher.observer.onError=function(t,e){console.log("onError"),console.log(t),console.log(e)},this._livePusher.observer.onWarning=function(t,e){console.log("onWarning"),console.log(t),console.log(e)})},t.prototype.supportTest=function(){this._TXLivePusher.checkSupport().then(function(t){console.log("checkSupport"),console.log(t)})},t.prototype.updateVideoQuality=function(t){this._livePusher.setVideoQuality(t)},t.prototype.updateAudioQuality=function(t){this._livePusher.setAudioQuality(t)},t.prototype.customProperty=function(t,e){this._livePusher.setProperty(t,e)},t.prototype.livePush=function(t){var e=this;this._livePusher.startCamera().then(function(){console.log("\u6253\u5f00\u6444\u50cf\u5934\u6210\u529f");var n=Date.now()+86400,o="webrtc://"+i.default.PushStreamUrl+"/"+i.default.AppName+"/"+t+"?txSecret=Md5("+i.default.TXYPushKey+"+"+t+"+hex("+n+"))&txTime=hex("+n+")";console.log(o),e._livePusher.startPush(o)}).catch(function(t){console.log("\u6253\u5f00\u6444\u50cf\u5934\u5931\u8d25: "+t.toString())})},t.prototype.stoplive=function(){this._livePusher.stopCamera(),this._livePusher.stopMicrophone(),this._livePusher.stopPush()},t.prototype.SwitchCamera=function(t){t&&this._livePusher.startCamera(),!t&&this._livePusher.stopCamera()},t.prototype.SwitchMicrophone=function(t){t&&this._livePusher.startMicrophone(),!t&&this._livePusher.stopMicrophone()},t.prototype.quit=function(){this.stoplive(),this._livePusher.destroy()},t.prototype.pullLive=function(t){this._player=this._TCPlayer(this._player_container_id,{sources:[{src:"webrtc://"+i.default.PullStreamUrl+"/"+i.default.AppName+"/"+t}],licenseUrl:i.default.TXYLicenseURL})},t.prototype.SwitchPlayLive=function(t){t&&this._player.play(),!t&&this._player.pause()},t._inst=null,t}();n.default=o,cc._RF.pop()},{"./GlobelContext":"GlobelContext"}]},{},["CanvasVideo ","GlobelContext","ReqHttp","txySdk","test","test2"]);