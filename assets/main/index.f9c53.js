window.__require=function t(e,n,o){function i(c,s){if(!n[c]){if(!e[c]){var u=c.split("/");if(u=u[u.length-1],!e[u]){var l="function"==typeof __require&&__require;if(!s&&l)return l(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+c+"'")}c=u}var a=n[c]={exports:{}};e[c][0].call(a.exports,function(t){return i(e[c][1][t]||t)},a,a.exports,t,e,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({"CanvasVideo ":[function(t,e,n){"use strict";cc._RF.push(e,"97b4a+8tjJLbZqF167K6xQG","CanvasVideo ");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c},c=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function c(t){try{u(o.next(t))}catch(e){r(e)}}function s(t){try{u(o.throw(t))}catch(e){r(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,s)}u((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return u([t,e])}}function u(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("./common/txySdk"),l=cc._decorator,a=l.ccclass,p=(l.property,l.requireComponent),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.liveBtn=null,e.quitBtn=null,e.openBtn=null,e.closeBtn=null,e.pullBtn=null,e.playBtn=null,e.pauseBtn=null,e.spriteFrameCache=[],e.index=0,e}return i(e,t),e.prototype.start=function(){u.default.inst.initSdk(),this.liveBtn=cc.find("layout/live",this.node.parent),this.quitBtn=cc.find("layout/quit",this.node.parent),this.openBtn=cc.find("layout/openCamera",this.node.parent),this.closeBtn=cc.find("layout/closeCamera",this.node.parent),this.pullBtn=cc.find("layout/pull",this.node.parent),this.playBtn=cc.find("layout/play",this.node.parent),this.pauseBtn=cc.find("layout/pause",this.node.parent),this.liveBtn.on("click",this.onClickLiveBtn.bind(this)),this.quitBtn.on("click",this.onClickQuitBtn.bind(this)),this.openBtn.on("click",this.onClickOpenBtn.bind(this)),this.closeBtn.on("click",this.onClickCloseBtn.bind(this)),this.pullBtn.on("click",this.onClickPullBtn.bind(this)),this.playBtn.on("click",this.onClickPlayBtn.bind(this)),this.pauseBtn.on("click",this.onClickPauseBtn.bind(this))},e.prototype.onClickLiveBtn=function(){this.visSize=new cc.Size(this.node.width,this.node.height),this.init()},e.prototype.onClickQuitBtn=function(){u.default.inst.stoplive()},e.prototype.onClickOpenBtn=function(){u.default.inst.SwitchCamera(!0)},e.prototype.onClickCloseBtn=function(){u.default.inst.SwitchCamera(!1)},e.prototype.onClickPullBtn=function(){u.default.inst.pullLive(10001)},e.prototype.onClickPlayBtn=function(){u.default.inst.SwitchPlayLive(!0)},e.prototype.onClickPauseBtn=function(){u.default.inst.SwitchPlayLive(!1)},e.prototype.init=function(){var t=this,e=document.createElement("canvas");e.width=this.node.width,e.height=this.node.height,this._canvas=e,this._canvasCtx=e.getContext("2d"),this._sprite=this.getComponent(cc.Sprite),this._texture=new cc.Texture2D;for(var n=0;n<2;n++)this.spriteFrameCache.push(new cc.SpriteFrame);this.bind(function(){u.default.inst.livePush(10001),t.unschedule(t.updateTexture),t.schedule(t.updateTexture,.04,cc.macro.REPEAT_FOREVER)})},e.prototype.updateTexture=function(){return c(this,void 0,Promise,function(){var t;return s(this,function(){return null==this._video?[2]:(this._canvasCtx.drawImage(this._video,0,0,this.visSize.width,this.visSize.height),this._texture.initWithElement(this._canvas),(t=this.spriteFrameCache[this.index]).setTexture(this._texture),this._sprite.spriteFrame=t,this.index=1^this.index,[2])})})},e.prototype.bind=function(t){this._video=document.querySelector("#local_video").children[0],t()},e.prototype.handleSuccess=function(){},e.prototype.handleError=function(t){console.log("\u7ed1\u5b9a\u5931\u8d25:"),console.log(t)},e.prototype.clearSprite=function(){this._sprite.spriteFrame=null},r([a,p(cc.Sprite)],e)}(cc.Component);n.default=h,cc._RF.pop()},{"./common/txySdk":"txySdk"}],GlobelContext:[function(t,e,n){"use strict";cc._RF.push(e,"d52c7CqhixGMpdToUdxzngT","GlobelContext"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.TXYLicenseURL="https://license.vod2.myqcloud.com/license/v2/1311608929_1/v_cube.license",t.AppName="ouone",t.PushStreamUrl="168799.livepush.myqcloud.com",t.PullStreamUrl="push.ouwan.hmzb.top.txlivecdn.com",t}();n.default=o,cc._RF.pop()},{}],ReqHttp:[function(t,e,n){"use strict";cc._RF.push(e,"2fb017Mu31DW6ZqCLZaDXp5","ReqHttp"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.getInst=function(){return this._inst||(this._inst=new t),this._inst},Object.defineProperty(t,"inst",{get:function(){return this.getInst()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"xhr",{get:function(){return this._xhr||(this._xhr=cc.loader.getXMLHttpRequest()),this._xhr},enumerable:!1,configurable:!0}),t.post=function(t,e,n){var o=this.xhr;o.open("POST",t),o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<=207){var t=o.responseText;n(t)}},o.send(e)},t.get=function(t,e,n){var o=this.xhr;o.open("GET",t+e),o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<=207){var t=o.responseText;n(t)}},o.send()},t._inst=null,t._xhr=null,t}();n.default=o,cc._RF.pop()},{}],test2:[function(t,e,n){"use strict";cc._RF.push(e,"1fbf8Z4yHxF17SGRgp2kpLm","test2");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=t("./txySdk"),s=cc._decorator,u=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){c.default.inst.initSdk(),c.default.inst.livePush()},r([u],e)}(cc.Component));n.default=l,cc._RF.pop()},{"./txySdk":void 0}],test:[function(t,e,n){"use strict";cc._RF.push(e,"9a5aeQuIWZNqJrTSr+WITEF","test");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){if(window.wx){console.log("wx:"),console.log(window.wx);var t=window.wx;t.getUserInfo({success:function(t){console.log(t)}}),this.scheduleOnce(function(){var e={appId:"wxec08df14b53cbf89",path:"",success:function(){console.log("navigateToMiniProgram succ!!!")},fail:function(){console.log("navigateToMiniProgram fail!!!")}};t.navigateToMiniProgram(e)},5)}},r([s],e)}(cc.Component));n.default=u,cc._RF.pop()},{}],txySdk:[function(t,e,n){"use strict";cc._RF.push(e,"89808JMGt9O5bpGwBRgJMhI","txySdk"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./GlobelContext"),i=window.TXLivePusher,r=window.TCPlayer,c=function(){function t(){this._content="local_video",this._player_container_id="player-container-id",this._livePusher=null,this._player=null}return t.getInst=function(){return this._inst||(this._inst=new t),this._inst},Object.defineProperty(t,"inst",{get:function(){return this.getInst()},enumerable:!1,configurable:!0}),t.prototype.initSdk=function(){i&&(this._livePusher=new i,this._livePusher.setRenderView(this._content),this._livePusher.videoView.muted=!0)},t.prototype.supportTest=function(){i.checkSupport().then(function(t){console.log("checkSupport"),console.log(t)})},t.prototype.updateVideoQuality=function(t){this._livePusher.setVideoQuality(t)},t.prototype.updateAudioQuality=function(t){this._livePusher.setAudioQuality(t)},t.prototype.customProperty=function(t,e){this._livePusher.setProperty(t,e)},t.prototype.livePush=function(t){var e=this;this._livePusher.startCamera().then(function(){console.log("\u6253\u5f00\u6444\u50cf\u5934\u6210\u529f"),console.log("webrtc://"+o.default.PushStreamUrl+"/"+o.default.AppName+"/"+t),e._livePusher.startPush("webrtc://"+o.default.PushStreamUrl+"/"+o.default.AppName+"/"+t)}).catch(function(t){console.log("\u6253\u5f00\u6444\u50cf\u5934\u5931\u8d25: "+t.toString())})},t.prototype.stoplive=function(){this._livePusher.stopCamera(),this._livePusher.stopMicrophone(),this._livePusher.stopPush()},t.prototype.SwitchCamera=function(t){t&&this._livePusher.startCamera(),!t&&this._livePusher.stopCamera()},t.prototype.SwitchMicrophone=function(t){t&&this._livePusher.startMicrophone(),!t&&this._livePusher.stopMicrophone()},t.prototype.quit=function(){this._livePusher.isPushing()&&this.stoplive(),this._livePusher.destroy()},t.prototype.pullLive=function(t){this._player=r(this._player_container_id,{sources:[{src:"webrtc://"+o.default.PullStreamUrl+"/"+o.default.AppName+"/"+t}],licenseUrl:o.default.TXYLicenseURL})},t.prototype.SwitchPlayLive=function(t){t&&this._player.play(),!t&&this._player.pause()},t._inst=null,t}();n.default=c,cc._RF.pop()},{"./GlobelContext":"GlobelContext"}]},{},["CanvasVideo ","GlobelContext","ReqHttp","txySdk","test","test2"]);